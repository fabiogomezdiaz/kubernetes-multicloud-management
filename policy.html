<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.codehilite {background-color:#fff;color:#333333;}
.codehilite .hll {background-color:#ffffcc;}
.codehilite .c{color:#999988;font-style:italic}
.codehilite .err{color:#a61717;background-color:#e3d2d2}
.codehilite .k{font-weight:bold}
.codehilite .o{font-weight:bold}
.codehilite .cm{color:#999988;font-style:italic}
.codehilite .cp{color:#999999;font-weight:bold}
.codehilite .c1{color:#999988;font-style:italic}
.codehilite .cs{color:#999999;font-weight:bold;font-style:italic}
.codehilite .gd{color:#000000;background-color:#ffdddd}
.codehilite .ge{font-style:italic}
.codehilite .gr{color:#aa0000}
.codehilite .gh{color:#999999}
.codehilite .gi{color:#000000;background-color:#ddffdd}
.codehilite .go{color:#888888}
.codehilite .gp{color:#555555}
.codehilite .gs{font-weight:bold}
.codehilite .gu{color:#800080;font-weight:bold}
.codehilite .gt{color:#aa0000}
.codehilite .kc{font-weight:bold}
.codehilite .kd{font-weight:bold}
.codehilite .kn{font-weight:bold}
.codehilite .kp{font-weight:bold}
.codehilite .kr{font-weight:bold}
.codehilite .kt{color:#445588;font-weight:bold}
.codehilite .m{color:#009999}
.codehilite .s{color:#dd1144}
.codehilite .n{color:#333333}
.codehilite .na{color:teal}
.codehilite .nb{color:#0086b3}
.codehilite .nc{color:#445588;font-weight:bold}
.codehilite .no{color:teal}
.codehilite .ni{color:purple}
.codehilite .ne{color:#990000;font-weight:bold}
.codehilite .nf{color:#990000;font-weight:bold}
.codehilite .nn{color:#555555}
.codehilite .nt{color:navy}
.codehilite .nv{color:teal}
.codehilite .ow{font-weight:bold}
.codehilite .w{color:#bbbbbb}
.codehilite .mf{color:#009999}
.codehilite .mh{color:#009999}
.codehilite .mi{color:#009999}
.codehilite .mo{color:#009999}
.codehilite .sb{color:#dd1144}
.codehilite .sc{color:#dd1144}
.codehilite .sd{color:#dd1144}
.codehilite .s2{color:#dd1144}
.codehilite .se{color:#dd1144}
.codehilite .sh{color:#dd1144}
.codehilite .si{color:#dd1144}
.codehilite .sx{color:#dd1144}
.codehilite .sr{color:#009926}
.codehilite .s1{color:#dd1144}
.codehilite .ss{color:#990073}
.codehilite .bp{color:#999999}
.codehilite .vc{color:teal}
.codehilite .vg{color:teal}
.codehilite .vi{color:teal}
.codehilite .il{color:#009999}
.codehilite .gc{color:#999;background-color:#EAF2F5}
</style><title>policy</title></head><body><article class="markdown-body"><h1 id="mcm-compliance-manager">MCM Compliance Manager<a class="headerlink" href="#mcm-compliance-manager" title="Permanent link"></a></h1>
<p><strong>Author:</strong> Fabio Gomez (<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#102;&#97;&#98;&#105;&#111;&#103;&#111;&#109;&#101;&#122;&#64;&#117;&#115;&#46;&#105;&#98;&#109;&#46;&#99;&#111;&#109;">&#102;&#97;&#98;&#105;&#111;&#103;&#111;&#109;&#101;&#122;&#64;&#117;&#115;&#46;&#105;&#98;&#109;&#46;&#99;&#111;&#109;</a>)</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link"></a></h2>
<p>In the previous chapter we spoke of the complexities of managing applications across multiple clusters and how MCM takes that complexity away with its placement policies. We also covered a DevOps demo where you can get first hand experience on how easy it is to deploy an application to multiple clusters by leveraging MCM&rsquo;s placement policies.</p>
<p>What was not mentioned in the above scenario was that, outside of setting up MCM Hub Cluster and Klusterlets properly, to get the Guestbook app to work we had to create a <a href="https://www.ibm.com/support/knowledgecenter/en/SSBS6K_3.1.2/manage_images/image_security.html"><code>Cluster Image Policy</code></a> in both clusters to allow them to download Docker images from Docker Hub and other Docker registries. This manual step may be trivial when you have just 2 clusters. However, the more granular your configuration requirements become and the more environments/clusters you have, it gets more difficult, time-consuming, and error-prone to manage cluster configuration.</p>
<p>Configuration management tools, such as <code>Chef</code> &amp; <code>Ansible</code>, have existed for a while and have become paramount for managing infrastructure configuration at scale. However, at the time of writing, there is no major configuration management solution for Kubernetes native resources such as <code>Deployments</code>, <code>Quotas</code>, <code>Roles</code>, <code>Role Bindings</code>, etc.</p>
<p>MCM attempts to solve this with its <a href="https://www.ibm.com/support/knowledgecenter/en/SSBS6K_3.1.2/mcm/compliance/compliance_intro.html"><code>MCM Compliance Manager</code></a> feature, which provides a desired state-based management approach for enforcing custom compliance policies (explained in later sections) on clusters that are managed by MCM. Such policies allow you to, for example, enforce the existence of any Kubernetes resource across all of your Kubernetes clusters. The <code>Cluster Image Policy</code> scenario mentioned above is a clear use case for MCM Compliance Manager. The MCM Compliance Manager policies also allow you to simply inform you of the existence or non-existence of a Kubernetes resource across your clusters without the need of enforcement, thus showing compliance status of individual clusters.</p>
<h2 id="the-basics">The Basics<a class="headerlink" href="#the-basics" title="Permanent link"></a></h2>
<p>There are 5 concepts that you need to understand to make sense of the Compliance Manager&rsquo;s features. These concepts are:</p>
<ul>
<li><strong>Template</strong></li>
<li><strong>Policy</strong></li>
<li><strong>Compliance</strong></li>
<li><strong>Placement Policy</strong></li>
<li><strong>Placement Binding</strong></li>
</ul>
<p>In the following sections we will be explaining the concepts above. However, for this to make sense, we will apply the concepts to a single use case with the following criteria:</p>
<ul>
<li>2 <strong>IBM Cloud Private</strong> clusters that are managed by MCM.</li>
<li>Each cluster is required to have a <strong>Role</strong> called <code>operator-role</code>.</li>
<li>The <code>operator-role</code> <strong>MUST</strong> have the following access to <code>pod</code> resources.<ul>
<li><code>get</code></li>
<li><code>list</code></li>
<li><code>watch</code></li>
</ul>
</li>
<li>The <code>operator-role</code> must **NOT have the following access to <code>secrets</code> resources:<ul>
<li><code>get</code></li>
<li><code>list</code></li>
<li><code>watch</code></li>
<li><code>delete</code></li>
<li><code>create</code></li>
<li><code>update</code></li>
<li><code>patch</code></li>
</ul>
</li>
<li>If the <code>operator-role</code> does not exist, MCM will <code>enforce</code> it into existence.</li>
<li>The enforcement applies only to clusters with the following labels and values:<ul>
<li><strong>vendor</strong>: <code>ICP</code></li>
</ul>
</li>
</ul>
<h3 id="template">Template<a class="headerlink" href="#template" title="Permanent link"></a></h3>
<p>Starting at the bottom, we have <code>Template</code>. A Template defines a list of <code>policyRule</code>s that determine whether a particular Kubernetes Resource is compliant or not. These rules are basically a list of attributes that the given Kubernetes Resource must and/or must not have in order to be compliant.</p>
<p>To better understand a <code>Template</code>, let&rsquo;s look an actual YAML file for a Template of kind <code>RoleTemplate</code>:
<div class="codehilite"><pre><span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">roletemplate.mcm.ibm.com/v1alpha1</span>
<span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">RoleTemplate</span>
<span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means the role must exist with the rules that it musthave below</span>
<span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span> <span class="c1"># will be inferred</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">operator</span>
<span class="l l-Scalar l-Scalar-Plain">rules</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a musthave</span>
    <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;extensions&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;apps&quot;</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;deployments&quot;</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;mustnothave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a mustnothave</span>
    <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;core&quot;</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;core&quot;</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;secrets&quot;</span><span class="p p-Indicator">]</span>
      <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
</pre></div></p>
<p>Here is a breakdown of the fields above:</p>
<ul>
<li><strong>apiVersion</strong>: The path where the custom API is defined.</li>
<li><strong>kind</strong>: Defines the template kind, which is <code>RoleTemplate</code> in this case.</li>
<li><strong>complianceType</strong>: This field determines whether the resource (<code>Role</code> in this case) that matches the given <code>rules</code> must exist or not.<ul>
<li><code>musthave</code>: Means that the resource with the matching <code>rules</code> must exist.</li>
<li><code>mustnothave</code>: Means that the resource with the matching <code>rules</code> must NOT exist.</li>
</ul>
</li>
<li><strong>metadata</strong>:<ul>
<li><strong>namespace</strong>: The Kubernetes namespace for the template.</li>
<li><strong>name</strong>: The name of the template.</li>
</ul>
</li>
</ul>
<p>Note that the above fields are specific to <code>Template</code>s in general. The following fields are specific to <code>RoleTemplate</code>:</p>
<ul>
<li><strong>rules</strong>: List of rules (<code>policyRule</code> in this case) that will determine the compliance of a resource (<code>Role</code> in this case).<ul>
<li><strong>complianceType</strong>: <code>musthave</code> or <code>mustnothave</code>. Similar to a Template&rsquo;s higher level <code>complianceType</code>, this field determines whether the rule inside the template must exist or not.</li>
<li><strong>policyRule</strong>: This is the actual compliance rule, which is defined by the fields below:<ul>
<li><strong>apiGroups</strong>: Array of API Groups to apply this rule against.</li>
<li><strong>resources</strong>: Array of Resources from API Groups mentioned above to apply this rule against.</li>
<li><strong>verbs</strong>: Array of verbs that apply to the API Groups and Resources mentioned above.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The contents of the templates will vary based on the target Kubernetes resource. But just know that the contents of a template is what defines the rules that Compliance Manager will be checking for in order to meet compliance.</p>
<p>A <strong>Template</strong> is the most important concept to grasp correctly as everything that follows revolves around it. But don&rsquo;t worry, it&rsquo;s all downhill from here.</p>
<h3 id="policy">Policy<a class="headerlink" href="#policy" title="Permanent link"></a></h3>
<p>Now that we understand what a <code>Template</code> is, it will be much easier to explain what a <code>Policy</code> is. A <code>Policy</code> is responsible for the following:
* Take a list of <code>Template</code>s and enforce their rules in a cluster.
* Determine which namespaces to enforce the rules into.
* Determine what remediation action to take when compliance is not met.</p>
<p>To better understand a <code>Policy</code>, let&rsquo;s look an actual YAML file for a Policy object:
<div class="codehilite"><pre><span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">policy.mcm.ibm.com/v1alpha1</span>
<span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">policy02</span>
  <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Instance descriptor for policy resource</span>
<span class="l l-Scalar l-Scalar-Plain">spec</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">remediationAction</span><span class="p p-Indicator">:</span> <span class="s">&quot;enforce&quot;</span> <span class="c1"># or inform</span>
  <span class="l l-Scalar l-Scalar-Plain">namespaces</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">include</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;default&quot;</span><span class="p p-Indicator">]</span>
    <span class="l l-Scalar l-Scalar-Plain">exclude</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;kube*&quot;</span><span class="p p-Indicator">]</span>
  <span class="l l-Scalar l-Scalar-Plain">role-templates</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">RoleTemplate</span>
      <span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">roletemplate.mcm.ibm.com/v1alpha1</span>
      <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means the role must exist with the rules that it musthave below</span>
      <span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span> <span class="c1"># will be inferred</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">operator</span>
      <span class="l l-Scalar l-Scalar-Plain">rules</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a musthave</span>
          <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;extensions&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;apps&quot;</span><span class="p p-Indicator">]</span>
            <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;deployments&quot;</span><span class="p p-Indicator">]</span>
            <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">]</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;mustnothave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a mustnothave</span>
          <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;core&quot;</span><span class="p p-Indicator">]</span>
            <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
            <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;core&quot;</span><span class="p p-Indicator">]</span>
            <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;secrets&quot;</span><span class="p p-Indicator">]</span>
            <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
</pre></div></p>
<p>Here is a breakdown of the fields above:</p>
<ul>
<li><strong>apiVersion</strong>: The path where the custom API is defined.</li>
<li><strong>kind</strong>: <code>Policy</code> in this case.</li>
<li><strong>spec</strong>:<ul>
<li><strong>remediationAction</strong>: this is where you specify what you would like the Compliance Manager to do when there is a non-compliance for the given Policy. Here are the options:<ul>
<li><code>enforce</code>: If non-compliance is found, enforce policy by creating/deleting the resources in <code>role-templates</code>.</li>
<li><code>inform</code>: If non-compliance is found, don&rsquo;t enforce policy but inform the MCM Admin of the non-compliance via the Dashboard.</li>
</ul>
</li>
<li><strong>namespaces</strong>: These are the namespaces where the policies will be inforced in.
    <strong>include</strong>: Array or expression of namespaces to INCLUDE in the policy checks.
    <strong>exclude</strong>: Array or expression of namespaces to EXCLUDE in the policy checks.</li>
<li><strong>role-templates</strong>: List of Templates (<code>RoleTemplates</code> in this case), which contain the rules to enforce.</li>
</ul>
</li>
</ul>
<p>Note that, we skipped <code>role-templates</code> as we already broke down and explained the contents of a Template. The only comment to add is that the templates&rsquo; namespace will be inherited from the Policy&rsquo;s <code>namespaces</code> field.</p>
<h3 id="compliance">Compliance<a class="headerlink" href="#compliance" title="Permanent link"></a></h3>
<p>We now understand that a <code>Template</code> defines the rules to enforce and a <code>Policy</code> defines how and where (namespaces) the rules are enforced in a cluster. However, a <code>Policy</code> must still be a applied to each cluster. Applying the policies manually may be fine for 1 or 2 clusters. But once again, the more abundant and more granular the policies become and the more clusters you have to manage, the more cumbersome managing the policies become.</p>
<p>Luckily, the Compliance Manager can manage this for you with a <code>Compliance</code> object. A <code>Compliance</code> object takes a list of <code>Policy</code> objects (and their respective <code>Template</code>s) and determines what clusters to apply them to based on cluster selectors. A <code>Compliance</code>, though not apparent by its name alone, is the final piece that ties the policies into the actual infrastructure (clusters) and, therefore, fully implement Compliance.</p>
<p>To better understand a <code>Compliance</code>, let&rsquo;s look an actual YAML file for a Compliance object, which contains 2 Policy objects:
<div class="codehilite"><pre><span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">compliance.mcm.ibm.com/v1alpha1</span>
<span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Compliance</span>
<span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">compliance1</span>
  <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mcm</span>
  <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Instance descriptor for compliance resource</span>
<span class="l l-Scalar l-Scalar-Plain">spec</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">clusterSelector</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">matchNames</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;se-stg-31&quot;</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;se-dev-31&quot;</span>
<span class="c1">#    matchLabels:</span>
<span class="c1">#      cloud: &quot;IBM&quot;</span>
<span class="c1">#      hippa: &quot;true&quot;</span>
<span class="c1">#    matchExpressions:</span>
<span class="c1">#    - key: key1</span>
<span class="c1">#      operator: &quot;NotIn&quot;</span>
<span class="c1">#      values:</span>
<span class="c1">#      - &quot;cl3&quot;</span>
<span class="c1">#      - &quot;cl4&quot;</span>
<span class="c1">#    matchConditions:</span>
<span class="c1">#    - type: &quot;OK&quot;</span>
<span class="c1">#      status: &quot;True&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">runtime-rules</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">policy.mcm.ibm.com/v1alpha1</span>
      <span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Policy</span>
      <span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">policy01</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Instance descriptor for policy resource</span>
      <span class="l l-Scalar l-Scalar-Plain">spec</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">remediationAction</span><span class="p p-Indicator">:</span> <span class="s">&quot;inform&quot;</span> <span class="c1"># or inform</span>
        <span class="l l-Scalar l-Scalar-Plain">namespaces</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">include</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;default&quot;</span><span class="p p-Indicator">]</span>
          <span class="l l-Scalar l-Scalar-Plain">exclude</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;kube*&quot;</span><span class="p p-Indicator">]</span>
        <span class="l l-Scalar l-Scalar-Plain">role-templates</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">RoleTemplate</span>
            <span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">roletemplate.mcm.ibm.com/v1alpha1</span>
            <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means the role must exist with the rules that it musthave below</span>
            <span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
              <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span> <span class="c1"># will be inferred</span>
              <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
            <span class="l l-Scalar l-Scalar-Plain">selector</span><span class="p p-Indicator">:</span>
              <span class="c1"># matchLabels:</span>
              <span class="c1"># hipaa: &quot;true&quot;</span>
            <span class="l l-Scalar l-Scalar-Plain">rules</span><span class="p p-Indicator">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a musthave</span>
                <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
                  <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;extensions&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;apps&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;deployments&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">policy.mcm.ibm.com/v1alpha1</span>
      <span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Policy</span>
      <span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">policy02</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Instance descriptor for policy resource</span>
      <span class="l l-Scalar l-Scalar-Plain">spec</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">remediationAction</span><span class="p p-Indicator">:</span> <span class="s">&quot;enforce&quot;</span> <span class="c1"># or inform</span>
        <span class="l l-Scalar l-Scalar-Plain">namespaces</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">include</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;default&quot;</span><span class="p p-Indicator">]</span>
          <span class="l l-Scalar l-Scalar-Plain">exclude</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;kube*&quot;</span><span class="p p-Indicator">]</span>
        <span class="l l-Scalar l-Scalar-Plain">role-templates</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">RoleTemplate</span>
            <span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">roletemplate.mcm.ibm.com/v1alpha1</span>
            <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means the role must exist with the rules that it musthave below</span>
            <span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
              <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span> <span class="c1"># will be inferred</span>
              <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">operator</span>
            <span class="l l-Scalar l-Scalar-Plain">selector</span><span class="p p-Indicator">:</span>
              <span class="l l-Scalar l-Scalar-Plain">matchLabels</span><span class="p p-Indicator">:</span>
                <span class="l l-Scalar l-Scalar-Plain">hipaa</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
            <span class="l l-Scalar l-Scalar-Plain">rules</span><span class="p p-Indicator">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;musthave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a musthave</span>
                <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
                  <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;extensions&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;apps&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;deployments&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">]</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">complianceType</span><span class="p p-Indicator">:</span> <span class="s">&quot;mustnothave&quot;</span> <span class="c1"># at this level, it means if the role exists the rule is a mustnothave</span>
                <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
                  <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;core&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">policyRule</span><span class="p p-Indicator">:</span>
                  <span class="l l-Scalar l-Scalar-Plain">apiGroups</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;core&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;secrets&quot;</span><span class="p p-Indicator">]</span>
                  <span class="l l-Scalar l-Scalar-Plain">verbs</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;create&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;delete&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;update&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;patch&quot;</span><span class="p p-Indicator">]</span>
</pre></div></p>
<p>The above may look overwhelming, but outside a few fields specific to the <code>Compliance</code> object, there is nothing we haven&rsquo;t already seen above. Here is a breakdown of the fields above:</p>
<ul>
<li><strong>apiVersion</strong>: The path where the custom API is defined.</li>
<li><strong>kind</strong>: <code>Compliance</code> in this case.</li>
<li><strong>metadata</strong>: The common Kubernetes metadata object. There are a couple of fields that are of interest for Compliance Manager.<ul>
<li><strong>namespace</strong>: This is the name of the namespace that was created specifically for MCM to put Compliance objects during MCM installation.</li>
<li><strong>description</strong>: Description of the Compliance object, which will be displayed in the MCM Dashboard.</li>
</ul>
</li>
<li><strong>spec</strong>:<ul>
<li><strong>clusterSelector</strong>: Here is where we define the criteria to select the clusters where the policies will be applied and/or enforced. You can use a combination of the following filters to select clusters:<ul>
<li><strong>matchNames</strong>: List of cluster names to match against.</li>
<li><strong>matchLabels</strong>: List of cluster labels to match against. These are the labels which fields you for a cluster during Klusterlet installation.</li>
<li><strong>matchExpressions</strong>: List of expressions to match against.</li>
<li><strong>matchConditions</strong>: List of cluster conditions to match against, usually involving cluster health status.</li>
</ul>
</li>
<li><strong>runtime-rules</strong>: This is a list of <code>Policy</code> objects that will be applied to the clusters that match the criteria in <code>clusterSelector</code>.</li>
</ul>
</li>
</ul>
<p>Once again, the <code>Compliance</code> object is responsible for applying the specified <code>Policy</code> objects to the matching clusters and reporting status back to the Compliance Manager dashboard in MCM.</p>
<h2 id="placement-policy">Placement Policy<a class="headerlink" href="#placement-policy" title="Permanent link"></a></h2>
<p>Now that you understand the functionality of a <code>Compliance</code> object, it&rsquo;s time to decide what clusters to apply this <code>Compliance</code> to. For that, we need to create the following Custom Resources:</p>
<ul>
<li>A <code>Placement Policy</code> resource, where, via cluster labels, you define the rules for selecting the clusters to apply the Compliance object to.</li>
<li>A <code>Placement Binding</code> resource, where you bind a specific Placement Policy object to a specific Compliance object, which is the final step that tells MCM to start applying the Compliance object to the selected clusters.</li>
<li>We will go over Placement Binding in more detail in the next section.</li>
</ul>
<p>To better understand a <code>PlacementPolicy</code>, let&rsquo;s look an actual YAML file for a Placement Policy object:
<div class="codehilite"><pre><span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mcm.ibm.com/v1alpha1</span>
<span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">PlacementPolicy</span>
<span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">placement-policy-all-icp</span>
  <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mcm</span>
<span class="l l-Scalar l-Scalar-Plain">spec</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">clusterLabels</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">matchLabels</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ICP</span>
</pre></div></p>
<p>Here is a breakdown of the fields above:</p>
<ul>
<li><strong>apiVersion</strong>: The path where the custom API is defined.</li>
<li><strong>kind</strong>: <code>PlacementPolicy</code> in this case.</li>
<li><strong>spec</strong>:</li>
<li><strong>clusterLabels.matchLabels</strong>: Here is where we define the labels to select the clusters where the Compliance object will be applied to.<ul>
<li>In this case we used the label <code>vendor</code> with a value of <code>ICP</code>, which means to apply the Compliance object to all ICP clusters registered with MCM Controller.</li>
</ul>
</li>
</ul>
<h2 id="placement-binding">Placement Binding<a class="headerlink" href="#placement-binding" title="Permanent link"></a></h2>
<p>Now that we have both a Compliance object (with all its rules and templates) and a Placement Policy object, a <code>Placement Binding</code> resource is required to bind them together and start the process of applying the Compliance policies to the clusters based on the Placement Policy criteria.</p>
<p>To better understand a <code>PlacementBinding</code>, let&rsquo;s look an actual YAML file for a Placement Binding object:</p>
<div class="codehilite"><pre><span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mcm.ibm.com/v1alpha1</span>
<span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">PlacementBinding</span>
<span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">placement-binding-all-icp</span>
  <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mcm</span>
<span class="l l-Scalar l-Scalar-Plain">placementRef</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">placement-policy-all-icp</span>
<span class="l l-Scalar l-Scalar-Plain">subjects</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">compliance-all-icp</span>
  <span class="l l-Scalar l-Scalar-Plain">kind</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Compliance</span>
</pre></div>

<p>Here is a breakdown of the fields above:</p>
<ul>
<li><strong>apiVersion</strong>: The path where the custom API is defined.</li>
<li><strong>kind</strong>: <code>PlacementBinding</code> in this case.</li>
<li><strong>placementRef.name</strong>: The name of the Placement Policy to bind.</li>
<li><strong>subjects</strong>: The list of objects to bind the Placement Policy with.</li>
<li><strong>name</strong>: The name of the object to bind the Placement Policy with.</li>
<li><strong>kind</strong>: The type of object (Compliance in our case) that it&rsquo;s going to be bound with the Placement Policy.</li>
</ul>
<p>We have now introduced and explained all of the resources that are required to create and enforce Compliance Policies on Kubernetes Clusters. Now let&rsquo;s move on to a quick tutorial.</p>
<h2 id="compliance-manager-tutorial">Compliance Manager Tutorial<a class="headerlink" href="#compliance-manager-tutorial" title="Permanent link"></a></h2>
<p>Now that we know the basic concepts and understand on a high level the components that power the Compliance Manager, let&rsquo;s go ahead and apply a sample Compliance object to our clusters and see what that looks like on the Compliance Manager dashboard.</p>
<h3 id="pre-requisites">Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permanent link"></a></h3>
<p>This tutorial will assume you have the following pre-requisites:</p>
<ul>
<li><strong>2 IBM Cloud Private 3.1 Clusters loaded with the MCM 3.1.2 PPA loaded</strong></li>
<li><strong>Cluster 1 Setup</strong>:<ul>
<li><strong>Install MCM Controller Chart</strong><ul>
<li>Create a separate namespace called <code>mcm</code>, which will be used to store the <code>Compliance</code> objects.</li>
</ul>
</li>
<li><strong>Install MCM Klusterlet Chart and enter the following values:</strong><ul>
<li><strong>Name</strong>: se-stg-31</li>
<li><strong>Namespace</strong>: mcm-se-stg</li>
<li><strong>Labels</strong>:<ul>
<li><strong>cloud</strong>: IBM</li>
<li><strong>datacenter</strong>: dallas</li>
<li><strong>environment</strong>: Staging</li>
<li><strong>owner</strong>: case</li>
<li><strong>region</strong>: US</li>
<li><strong>vendor</strong>: ICP</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Cluster 2 Setup</strong>:<ul>
<li><strong>Install MCM Klusterlet Chart and enter the following values:</strong><ul>
<li><strong>Name</strong>: se-dev-31</li>
<li><strong>Namespace</strong>: mcm-se-dev</li>
<li><strong>Labels</strong>:<ul>
<li><strong>cloud</strong>: IBM</li>
<li><strong>datacenter</strong>: austin</li>
<li><strong>environment</strong>: Dev</li>
<li><strong>owner</strong>: case</li>
<li><strong>region</strong>: US</li>
<li><strong>vendor</strong>: ICP</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="1-apply-the-compliance">1. Apply the Compliance<a class="headerlink" href="#1-apply-the-compliance" title="Permanent link"></a></h3>
<p>Now that we have installed MCM in both clusters, let&rsquo;s create a <code>Compliance</code> object located at <a href="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/demos/compliance/compliance-v0.2.yaml">cookbook/docs/demos/compliance/compliance-v0.2.yaml</a>. Here is a high level breakdown of the contents of the <code>Compliance</code> object:</p>
<ul>
<li>A cluster selector that uses <code>matchNames</code> to select clusters matching the names listed.</li>
<li>A <code>Policy</code> that only <code>inform</code>s whether compliance is met based on the policy&rsquo;s <code>RoleTemplate</code>.<ul>
<li>This means the roles in the <code>RoleTemplate</code> won&rsquo;t be created by the Policy even if the cluster is found non-compliant.</li>
</ul>
</li>
<li>A <code>Policy</code> that <code>enforce</code>s the creation of the policy&rsquo;s <code>RoleTemplate</code> if the cluster is found non-compliant.<ul>
<li>This means that even if the cluster was found compliant and, for some reason, a cluster admin deletes the role, the Compliance Manager will recreate it.</li>
</ul>
</li>
</ul>
<p>Let&rsquo;s proceed with the <code>Compliance</code> object creation. If your cluster names are different to the ones mentioned in the previous section, make sure to open the compliance file and change the cluster names in lines <a href="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/demos/compliance/compliance-v0.2.yaml#L12">12</a> and <a href="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/demos/compliance/compliance-v0.2.yaml#L13">13</a> to be the names of your clusters as indicated when installing the Klusterlet, then save the file.
<div class="codehilite"><pre><span class="c1"># Login against MCM Hub Cluster</span>
cloudctl login -a https://<span class="si">${</span><span class="nv">MCM_HUB_CLUSTER_MASTER_IP</span><span class="si">}</span>:8443 -u <span class="si">${</span><span class="nv">USERNAME</span><span class="si">}</span> -p <span class="si">${</span><span class="nv">PASSWORD</span><span class="si">}</span> -n mcm --skip-ssl-validation<span class="p">;</span>

<span class="c1"># Clone the repo</span>
git clone git@github.ibm.com:CASE/refarch-mcm.git

<span class="c1"># Cd to repo folder</span>
<span class="nb">cd </span>refarch-mcm

<span class="c1"># Apply the Compliance</span>
kubectl apply -f cookbook/docs/demos/compliance/compliance-v0.2.yaml
</pre></div></p>
<p>Where:</p>
<ul>
<li><code>${MCM_HUB_CLUSTER_MASTER_IP}</code> is the IP Address of the master node in the MCM Hub Cluster.</li>
<li><code>${USERNAME}</code> is admin user.</li>
<li><code>${PASSWORD}</code> is the admin password.</li>
<li><code>mcm</code> is the namespace in which the <code>Compliance</code> object will be created.</li>
</ul>
<p>In the next section, we will use the MCM Compliance Manager dashboar to see the compliance results of the above <code>Compliance</code> object.</p>
<h3 id="2-view-compliance-status-on-the-dashboard">2. View Compliance Status on the Dashboard<a class="headerlink" href="#2-view-compliance-status-on-the-dashboard" title="Permanent link"></a></h3>
<p>To access the Policies view for the Compliance Manager, open a new browser window and go to https://${MCM_HUB_CLUSTER_MASTER_IP}:8443/multicloud/policies, where <code>${MCM_HUB_CLUSTER_MASTER_IP}</code> is the IP Address of the master node in the MCM Hub Cluster.</p>
<p>If the <code>Compliance</code> object was created successfully, you wil see a screen that looks like this:
<img alt="1. Compliance" src="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/images/policy/1-mcm-compliance.png?raw=true" /></p>
<p>Notice that under <code>Policy Compliant</code> only 2 out of 4 created policies are compliant, which means for both clusters only 1 of the policies is actually compliant. Because of this, none of the clusters are 100% compliant, as indicated by the <code>0/2</code> value under <code>Cluster Compliant</code> column.</p>
<p>Now click on <code>compliance1</code> to see more details on the <code>Compliance</code> object. The first thing you will see are some high level details for the <code>Compliance</code>, which are similar to what we saw in the previous screenshot:
<img alt="2. Compliance Details - 1" src="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/images/policy/2-mcm-compliance-details-1.png?raw=true" /></p>
<p>If you scroll further down you can see the following 2 sections:
<img alt="3. Compliance Details - 2" src="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/images/policy/3-mcm-compliance-details-2.png?raw=true" /></p>
<p>Here is a breakdown of the above 2 sections:</p>
<ul>
<li><strong>Compliance Status</strong>: The overall compliance status of an individual cluster.<ul>
<li><strong>Cluster Name</strong>: The name of the cluster.</li>
<li><strong>Policy Compliant</strong>: Ratio of compliant policies to total number of policies.</li>
<li><strong>Policy Valid</strong>: Ratio of policies with valid syntax to total number of policies.</li>
</ul>
</li>
<li><strong>Compliance Policies</strong>: A breakdown of all the policies and their compliance status for each cluster .<ul>
<li><strong>Compliant</strong>: Whether the given policy is compliant.</li>
<li><strong>Name</strong>: Name of the policy.</li>
<li><strong>Cluster Name</strong>: Name of the cluster that this policy belongs to.</li>
<li><strong>Valid</strong>: Whether the policy has a valid syntax.</li>
</ul>
</li>
</ul>
<p>The above should give you a high level idea of the compliance status for each policy in each cluster.</p>
<h3 id="3-view-individual-policy">3. View Individual Policy<a class="headerlink" href="#3-view-individual-policy" title="Permanent link"></a></h3>
<p>The above section showed us how to get a high level compliance status for each policy on each cluster. If we want to investigate, for example, what exactly causing the policies to show a non-compliant status, the we have to inspect the contents of the policy itself.</p>
<p>To view the contents of any policy, click the name of the policy in the <code>Compliance Policies</code> section shown in the last screenshot. For this example, we are going to click on <code>policy01</code> from the <code>se-dev-31</code> cluster.</p>
<p>You shold now be greeted with the following screen, which gives you the high level policy details, which gives you the Compliance <code>Status</code> (which is <code>NonCompliant</code>) and the <code>Enforcement</code> type (which is <code>inform)</code>:
<img alt="4. Policy Details - 1" src="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/images/policy/4-mcm-policy-details-1.png?raw=true" /></p>
<p>If you scroll down, you will encounter the <code>Template Details</code> and the <code>Rules</code> sections:
<img alt="5. Policy Details - 2" src="/Users/fabiogomez/Documents/Projects/case/mcm/kubernetes-multicloud-management/cookbook/docs/images/policy/5-mcm-policy-details-2.png?raw=true" /></p>
<p>Here is a breakdown of the above 2 sections:</p>
<ul>
<li><strong>Template Details</strong>:<ul>
<li><strong>Name</strong>: Name of the template, which is <code>dev</code> in this case.</li>
<li><strong>Last Transition</strong>: The compliance status change for the template.</li>
<li><strong>Template Type</strong>: The type of template, which is <code>role-template</code> in this case.</li>
</ul>
</li>
<li><strong>Rules</strong>:<ul>
<li><strong>Name</strong>: The name of the rule, which was auto-generated in this case to be <code>dev-rule-0</code></li>
<li><strong>Template Type</strong>: The type of template, which is <code>role-template</code> in this case.</li>
<li><strong>Compliance Type</strong>: This field determines whether the resource (<code>Role</code> in this case) that matches the given <code>rules</code> must exist or not, which in this case must exist based on its <code>musthave</code> value.</li>
<li><strong>API Groups</strong>: Array of API Groups to apply this rule against.</li>
<li><strong>Verbs</strong>: Array of verbs that apply to the API Groups and Resources.</li>
<li><strong>Resources</strong>: Array of Resources from API Groups mentioned above to apply this rule against.</li>
</ul>
</li>
</ul>
<h3 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link"></a></h3>
<p>Though this tutorial did not go into extreme detail on all possible <code>Compliance</code>, <code>Policy</code>, and <code>Template</code> iterations and compliance scenarios (which are left for the reader to experiment with), it did cover the basics on how to apply policies to clusters using <code>Compliance</code> objects.</p>
<p>The tutorial also covered how you can access the Compliance Manager dashboard to view the compliance status of all the policies and how to inspect non-compliant policies to understand the rules inside the policy templates.</p>
<p>The more you use the Compliance Manager and implement <code>Compliance</code> objects into more clusters, the easier it becomes to maintain increasingly complicated configurations across multiple clusters.</p>
<!--## Short End-to-End Video Demo
If you would like to see a more involved demo or prefer a video tutorial format, then feel free to checkout this video that was put together by the MCM Compliance Manager team.
[![Watch the video](images/policy/video-demo-screenshot.png)](https://COMING_SOON)--></article></body></html>